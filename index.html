<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Comercial Innova Ocular 2026</title>
    <!-- Tailwind CSS para el diseño -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React y ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel para procesar JSX en el navegador -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Recharts para los gráficos -->
    <script src="https://unpkg.com/recharts/umd/Recharts.js"></script>
    <!-- Lucide para los iconos -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .recharts-responsive-container { min-height: 250px; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 18px;
            width: 18px;
            border-radius: 50%;
            background: #2563eb;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(37, 99, 235, 0.3);
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;
        const { 
            BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Cell
        } = Recharts;

        const Icon = ({ name, size = 20, className = "" }) => {
            useEffect(() => {
                if (window.lucide) { window.lucide.createIcons(); }
            }, [name]);
            return <i data-lucide={name} style={{ width: size, height: size }} className={className}></i>;
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('overview');
            const [simulatedSales, setSimulatedSales] = useState(750000);

            // Objetivos 2026 (Basado en volúmenes del grupo)
            const objectives = [
                { label: 'Lentes Pseudofáquicas', total: 26500, goal: 2500, color: '#3b82f6', icon: 'target' },
                { label: 'Lentes Fáquicas', total: 2200, goal: 150, color: '#6366f1', icon: 'award' },
                { label: 'Viscoelásticos', total: 38000, goal: 3500, color: '#10b981', icon: 'package' }
            ];

            // Escala de Rappel (Acuerdo Total Biotech 2026)
            const rappelScale = [
                { limit: 250000, rate: 0.015 }, { limit: 500000, rate: 0.02 },
                { limit: 750000, rate: 0.025 }, { limit: 1000000, rate: 0.03 },
                { limit: 1250000, rate: 0.035 }, { limit: 1500000, rate: 0.04 },
                { limit: 1750000, rate: 0.045 }, { limit: 2000000, rate: 0.05 },
            ];

            // Listado consolidado de productos y precios netos
            const products = [
                { cat: 'Fáquicas', name: 'EYECRYL PHAKIC BAJA POTENCIA', price: 500, desc: 'SPH +0.50 a +2.75 / -0.50 a -6.00' },
                { cat: 'Fáquicas', name: 'EYECRYL PHAKIC ALTA POTENCIA (SPH)', price: 770, desc: 'SPH +3.00 a +10.00 / -6.50 a -25.00' },
                { cat: 'Fáquicas', name: 'EYECRYL PHAKIC ALTA POTENCIA (TOR)', price: 990, desc: 'Cilindros hasta +5D' },
                { cat: 'Fáquicas', name: 'EYECRYL PHAKIC CUSTOM', price: 1450, desc: 'SPH > -25D / +10D' },
                { cat: 'Premium', name: 'OPTIFLEX TRIO 3FLA6', price: 395, desc: 'Trifocal' },
                { cat: 'Premium', name: 'OPTIFLEX TRIO TORICA', price: 570, desc: 'Trifocal Tórica' },
                { cat: 'Premium', name: 'OPTIFLEX TRIO PLUS (NEW)', price: 420, desc: 'Trifocal Nueva Generación' },
                { cat: 'EDOF', name: 'EYECRYL SERT', price: 125, desc: 'EDOF Entry Level' },
                { cat: 'EDOF', name: 'EYECRYL SERT TORIC (CIL 1.0D)', price: 220, desc: 'EDOF Tórica' },
                { cat: 'Mono', name: 'OPTIFLEX GENESIS COMFORT NY', price: 95, desc: 'Precargada' },
                { cat: 'Mono', name: 'EYECRYL PLUS NATURAL HD', price: 75, desc: 'No precargada' },
                { cat: 'Visco', name: 'BIO HYALUR 1ML PFS', price: 13.73, desc: 'Hialuronato 1%' },
                { cat: 'Visco', name: 'BIO HYALUR PLUS 1ML PFS', price: 15.45, desc: 'Hialuronato 1.4%' },
                { cat: 'Visco', name: 'BIO HYALUR DUO', price: 26.68, desc: 'Cohesivo + Dispersivo' },
                { cat: 'Visco', name: 'BIO HYALUR HV 1ML PFS', price: 17.25, desc: 'Hialuronato 2.4%' },
                { cat: 'Visco', name: 'BIO HYALUR SV 1ML PFS', price: 18.13, desc: 'Hialuronato 3.0%' },
                { cat: 'Otros', name: 'BIO BLUE 1ML PFS', price: 9.25, desc: 'Colorante' },
                { cat: 'Otros', name: 'BIOBLUE 90 PLUS', price: 39.00, desc: 'ERM/ILM' },
                { cat: 'Otros', name: 'BIOSIL 10ML', price: 65.00, desc: 'VR Silicona' },
                { cat: 'Otros', name: 'BIO OCTANE', price: 50.00, desc: 'Perfluorocarbono' }
            ];

            const currentRappel = useMemo(() => {
                const level = [...rappelScale].reverse().find(r => simulatedSales >= r.limit);
                return level ? level : { limit: 0, rate: 0 };
            }, [simulatedSales]);

            const rappelAmount = simulatedSales * currentRappel.rate;

            return (
                <div className="max-w-7xl mx-auto p-4 md:p-10">
                    <div className="flex flex-col lg:flex-row lg:items-end justify-between gap-8 mb-12">
                        <div>
                            <div className="inline-block px-3 py-1 bg-blue-100 text-blue-700 text-[10px] font-black uppercase tracking-[0.2em] rounded-full mb-3">
                                Propuesta Comercial 2026
                            </div>
                            <h1 className="text-4xl lg:text-5xl font-black text-slate-900 tracking-tight">Innova Ocular</h1>
                            <p className="text-slate-500 font-medium text-lg mt-2">Plan Estratégico de Suministro Biotech</p>
                        </div>
                        <div className="flex bg-white p-1.5 rounded-2xl shadow-sm border border-slate-200 overflow-x-auto no-scrollbar">
                            {['overview', 'catalog', 'rappel'].map(tab => (
                                <button key={tab} onClick={() => setActiveTab(tab)}
                                    className={`px-8 py-3 rounded-xl text-sm font-bold transition-all duration-300 ${activeTab === tab ? 'bg-blue-600 text-white shadow-lg shadow-blue-200' : 'text-slate-500 hover:bg-slate-50'}`}>
                                    {tab === 'overview' ? 'Estrategia' : tab === 'catalog' ? 'Tarifario' : 'Simulador'}
                                </button>
                            ))}
                        </div>
                    </div>

                    {activeTab === 'overview' && (
                        <div className="space-y-10">
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                {objectives.map((obj, i) => (
                                    <div key={i} className="bg-white p-8 rounded-[32px] shadow-sm border border-slate-100 flex items-center justify-between">
                                        <div>
                                            <p className="text-xs font-bold text-slate-400 uppercase tracking-widest">{obj.label}</p>
                                            <h3 className="text-3xl font-black text-slate-900 tracking-tighter mt-1">
                                                {obj.goal.toLocaleString()} <span className="text-sm font-medium text-slate-400">UDS</span>
                                            </h3>
                                        </div>
                                        <div className="p-4 rounded-2xl bg-blue-50 text-blue-600">
                                            <Icon name={obj.icon} size={24} />
                                        </div>
                                    </div>
                                ))}
                            </div>

                            <div className="bg-white p-10 rounded-[40px] shadow-sm border border-slate-100">
                                <h3 className="font-black text-2xl text-slate-900 mb-8 tracking-tight">Potencial de Captura 2026</h3>
                                <div className="h-80 w-full">
                                    <ResponsiveContainer>
                                        <BarChart data={objectives} layout="vertical" margin={{ left: 20, right: 40 }}>
                                            <CartesianGrid strokeDasharray="3 3" horizontal={true} vertical={false} stroke="#f1f5f9" />
                                            <XAxis type="number" hide />
                                            <YAxis dataKey="label" type="category" width={160} tick={{fontSize: 12, fontWeight: 800, fill: '#64748b'}} />
                                            <Tooltip cursor={{fill: '#f8fafc'}} contentStyle={{borderRadius: '20px', border: 'none', boxShadow: '0 10px 15px -3px rgba(0,0,0,0.1)'}} />
                                            <Bar dataKey="total" fill="#f1f5f9" radius={[0, 8, 8, 0]} name="Total Grupo" />
                                            <Bar dataKey="goal" fill="#2563eb" radius={[0, 8, 8, 0]} name="Nuestro Objetivo" />
                                        </BarChart>
                                    </ResponsiveContainer>
                                </div>
                            </div>
                        </div>
                    )}

                    {activeTab === 'catalog' && (
                        <div className="bg-white rounded-[32px] shadow-sm border border-slate-100 overflow-hidden">
                            <table className="w-full text-left">
                                <thead className="bg-slate-50 border-b border-slate-100">
                                    <tr>
                                        <th className="p-6 text-[10px] font-black text-slate-400 uppercase tracking-widest">Producto</th>
                                        <th className="p-6 text-[10px] font-black text-slate-400 uppercase tracking-widest">Tipo</th>
                                        <th className="p-6 text-[10px] font-black text-slate-400 uppercase tracking-widest text-right">Precio Neto (€)</th>
                                    </tr>
                                </thead>
                                <tbody className="divide-y divide-slate-50 text-sm">
                                    {products.map((p, i) => (
                                        <tr key={i} className="hover:bg-blue-50/20 transition-colors">
                                            <td className="p-6">
                                                <div className="font-bold text-slate-900 uppercase text-[12px]">{p.name}</div>
                                                <div className="text-xs text-slate-400 mt-1">{p.desc}</div>
                                            </td>
                                            <td className="p-6">
                                                <span className="px-2 py-1 bg-slate-100 text-slate-500 rounded text-[9px] font-bold uppercase">{p.cat}</span>
                                            </td>
                                            <td className="p-6 text-right font-black text-blue-700">{p.price.toFixed(2)} €</td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    )}

                    {activeTab === 'rappel' && (
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-10">
                            <div className="bg-white p-10 rounded-[40px] border border-slate-100">
                                <h3 className="font-black text-2xl text-slate-900 mb-8 tracking-tight flex items-center gap-3">
                                    <Icon name="award" className="text-blue-600" /> Escalado Rappel
                                </h3>
                                <div className="space-y-3">
                                    {rappelScale.map((r, i) => (
                                        <div key={i} className={`p-5 rounded-2xl flex justify-between items-center border transition-all ${simulatedSales >= r.limit ? 'bg-emerald-50 border-emerald-200 text-emerald-900 shadow-sm' : 'bg-white border-slate-100 text-slate-300'}`}>
                                            <span className="text-sm font-bold">≥ {r.limit.toLocaleString()} €</span>
                                            <span className="font-black text-xl">{(r.rate * 100).toFixed(1)}%</span>
                                        </div>
                                    ))}
                                </div>
                            </div>
                            <div className="space-y-6">
                                <div className="bg-slate-900 p-10 rounded-[40px] text-white shadow-2xl">
                                    <p className="text-slate-500 text-[10px] font-black uppercase tracking-widest mb-2">Simulación Facturación</p>
                                    <h2 className="text-5xl font-black mb-8 tracking-tighter tabular-nums">{simulatedSales.toLocaleString()} <span className="text-xl font-normal text-slate-600">€</span></h2>
                                    <input type="range" min="100000" max="2500000" step="50000" value={simulatedSales} onChange={(e) => setSimulatedSales(Number(e.target.value))}
                                        className="w-full h-1.5 bg-slate-800 rounded-full appearance-none cursor-pointer mb-12" />
                                    <div className="grid grid-cols-2 gap-8 pt-8 border-t border-slate-800">
                                        <div>
                                            <p className="text-slate-500 text-[10px] font-black uppercase mb-2">Rappel Estimado</p>
                                            <p className="text-3xl font-black text-emerald-400 tabular-nums">{(simulatedSales * currentRappel.rate).toLocaleString()} €</p>
                                        </div>
                                        <div className="text-right">
                                            <p className="text-slate-500 text-[10px] font-black uppercase mb-2">Porcentaje</p>
                                            <p className="text-3xl font-black text-blue-500">{(currentRappel.rate * 100).toFixed(1)}%</p>
                                        </div>
                                    </div>
                                </div>
                                <div className="bg-amber-50 p-6 rounded-3xl border border-amber-100">
                                    <p className="text-xs text-amber-800 font-bold leading-relaxed italic">
                                        * Bonus por centro: Rappel individual acumulativo de hasta el 5,50% si el centro supera los 150.000 € de consumo anual.
                                    </p>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
